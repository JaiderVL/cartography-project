<div class="container mt-5">
  <h2 class="text-center mb-4">Lista de usuarios</h2>
  <div class="d-flex justify-content-between mb-3">
    <input type="text" class="form-control search-input" placeholder="Buscar usuario" [(ngModel)]="searchTerm">
    <a class="btn btn-link create-contact" (click)="openCreateUserModal()">+ Crear nuevo usuario</a>
  </div>
  
  <div *ngIf="!(users$ | async)?.length">
    <div class="alert alert-warning">No hay registros en el sistema!</div>
  </div>
  
  <div *ngIf="(users$ | async)?.length">
    <div class="table-responsive">
      <table class="table table-dark table-borderless table-hover">
        <thead>
          <tr>
            <th class="text-center">Nombre</th>
            <th class="text-center">Apellido</th>
            <th class="text-center">Correo</th>
            <th class="text-center">Zona</th>
            <th class="text-center">Rol</th>
            <th class="text-center">Funciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of (users$ | async | filter: searchTerm); trackBy: trackById">
            <td class="text-center">{{ user.name }}</td>
            <td class="text-center">{{ user.lastname }}</td>
            <td class="text-center">{{ user.email }}</td>
            <td class="text-center">{{ user.zone }}</td>
            <td class="text-center">{{ user.rol }}</td>
            <td class="text-center">
              <button class="btn btn-primary btn-circle btn-sm" (click)="updateUser(user)">
                <i class="bi bi-pencil-square"></i>
              </button>
              <button class="btn btn-danger btn-circle btn-sm ms-2" (click)="removeUser(user.id)">
                <i class="bi bi-trash3"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="showModal" class="modal custom-modal" tabindex="-1" style="display:block;">
    <div class="modal-dialog" [@modalAnimation]>
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-center">
          <h5 class="modal-title">{{ isEditMode ? 'Editar usuario' : 'Crear nuevo usuario' }}</h5>
          <button type="button" class="btn-close position-absolute end-0 me-3" (click)="closeCreateUserModal()"></button>
        </div>
        <div class="modal-body">
          <app-user-form [user]="selectedUser" [isEditMode]="isEditMode" (closeModal)="closeCreateUserModal()"></app-user-form>
        </div>
      </div>
    </div>
  </div>
</div>
